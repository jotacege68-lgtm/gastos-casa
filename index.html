<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gastos Hogar PRO</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <style>
        :root {
            --juan: #335eea;
            --tania: #d63384;
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text-main: #334155;
            --text-muted: #64748b;
            --header-h: 85px;
            --radius: 16px;
        }

        body { 
            font-family: 'Segoe UI', Roboto, -apple-system, sans-serif; 
            background: var(--bg); 
            margin: 0; 
            padding-top: calc(var(--header-h) + 15px); 
            color: var(--text-main); 
            -webkit-font-smoothing: antialiased;
        }

        /* Navegaci√≥n Superior */
        .tabs { 
            position: fixed; 
            top: 0; 
            width: 100%; 
            background: #ffffff; 
            display: flex; 
            height: var(--header-h); 
            box-shadow: 0 2px 15px rgba(0,0,0,0.05); 
            z-index: 1000; 
            overflow-x: auto; 
            scrollbar-width: none;
        }
        .tabs::-webkit-scrollbar { display: none; }

        .tab-btn { 
            flex: 1; 
            min-width: 85px; 
            border: none; 
            background: none; 
            font-size: 10px; 
            font-weight: 700; 
            color: var(--text-muted); 
            text-transform: uppercase; 
            cursor: pointer; 
            padding: 10px 5px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.2s ease;
            letter-spacing: 0.5px;
        }

        .tab-btn.active { 
            color: var(--juan) !important; 
            background: #f1f5f9; 
            border-bottom: 4px solid var(--juan);
        }

        /* Contenedores */
        .container { 
            padding: 12px; 
            display: none; 
            max-width: 480px; 
            margin: auto; 
            animation: fadeIn 0.3s ease-out;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

        .container.active { display: block; }

        .card { 
            background: var(--card-bg); 
            padding: 22px; 
            border-radius: var(--radius); 
            margin-bottom: 15px; 
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            border: 1px solid #f1f5f9;
        }

        /* Inputs y Selects */
        label { 
            display: block; 
            margin-bottom: 8px; 
            font-size: 12px; 
            font-weight: 700; 
            color: var(--text-muted); 
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        select, input { 
            width: 100%; 
            padding: 16px; 
            margin-bottom: 12px; 
            border: 1.5px solid #e2e8f0; 
            border-radius: 12px; 
            font-size: 16px; 
            box-sizing: border-box; 
            color: var(--text-main);
            background: #fdfdfd;
            appearance: none;
        }

        select:focus, input:focus {
            outline: none;
            border-color: var(--juan);
            background: #fff;
        }

        .nota-input { border-color: #fbbf24; background: #fffcf0; font-weight: 500; } 
        .input-cuotas { border-color: #10b981; background: #f0fdf4; font-weight: bold; }

        /* Botones */
        button { 
            width: 100%; 
            padding: 18px; 
            margin-bottom: 12px; 
            border: none; 
            border-radius: 14px; 
            font-weight: 700; 
            font-size: 15px; 
            cursor: pointer; 
            transition: opacity 0.2s, transform 0.1s;
        }
        button:active { transform: scale(0.98); opacity: 0.9; }

        .btn-juan { background: var(--juan); color: white; box-shadow: 0 4px 12px rgba(51, 94, 234, 0.2); }
        .btn-tania { background: var(--tania); color: white; box-shadow: 0 4px 12px rgba(214, 51, 132, 0.2); }
        .btn-cerrar { background: #059669; color: white; margin-top: 10px; }
        .btn-nav { background: #e2e8f0; color: var(--text-main); padding: 12px 20px; border-radius: 10px; width: auto; margin: 0; }

        /* Historial */
        .historial-item { 
            padding: 15px; 
            border-bottom: 1px solid #f1f5f9; 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
        }
        .item-jc { border-left: 5px solid #6366f1 !important; background: #f5f3ff !important; }
        .item-pagador { font-size: 10px; font-weight: 800; color: #94a3b8; background: #f1f5f9; padding: 2px 6px; border-radius: 4px; }
        .item-nota { font-size: 13px; color: #92400e; background: #fef3c7; padding: 4px 8px; border-radius: 6px; display: inline-block; margin: 4px 0; }

        /* Balance y Totales */
        .total-filtro { 
            background: #1e293b; 
            color: #fbbf24; 
            padding: 22px; 
            border-radius: var(--radius); 
            font-weight: 800; 
            font-size: 20px;
            text-align: center; 
            margin-bottom: 15px; 
        }
        .subtotal-seccion { 
            background: #f1f5f9; 
            color: var(--text-main); 
            padding: 10px 15px; 
            font-weight: 700; 
            font-size: 13px; 
            border-radius: 8px; 
            margin: 15px 0 8px 0; 
            border-left: 4px solid #cbd5e1;
            display: flex; justify-content: space-between;
        }
        .nav-historial, .nav-balance { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; background: white; padding: 10px; border-radius: 12px; }
        .balance-item { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px dashed #e2e8f0; }
        .resultado { margin-top: 20px; padding: 20px; border-radius: 12px; text-align: center; font-weight: 800; font-size: 18px; }
        .debe-juan { background: #fee2e2; color: #b91c1c; border: 1px solid #fecaca; }
        .debe-tania { background: #fce7f3; color: #9d174d; border: 1px solid #fbcfe8; }
    </style>
</head>
<body>

<nav class="tabs">
    <button class="tab-btn active" onclick="showTab('DIARIOS', this)">DIARIO</button>
    <button class="tab-btn" onclick="showTab('MENSUALES', this)">MENSUAL</button>
    <button class="tab-btn" onclick="showTab('JC', this)">SOLO JC</button>
    <button class="tab-btn" onclick="showTab('HISTORIAL', this)">HIST√ìRICO</button>
    <button class="tab-btn" onclick="showTab('BALANCE', this)">BALANCE</button>
    <button class="tab-btn" onclick="showTab('RESUMENES', this)">RES√öMENES</button>
</nav>

<div id="DIARIOS" class="container active">
    <div class="card">
        <label>RUBRO DIARIO (50/50)</label>
        <select id="select-diarios" onchange="toggleNota('diarios')"></select>
        <input type="text" id="nota-diarios" class="nota-input" placeholder="DETALLE / CONCEPTO" style="display:none">
        <input type="number" id="monto-diarios" inputmode="decimal" placeholder="MONTO $">
        <button class="btn-juan" onclick="guardarGasto('DIARIOS', 'JUAN')">PAG√ì JUAN</button>
        <button class="btn-tania" onclick="guardarGasto('DIARIOS', 'TANIA')">PAG√ì TANIA</button>
    </div>
</div>

<div id="MENSUALES" class="container">
    <div class="card">
        <label>RUBRO MENSUAL (50/50)</label>
        <select id="select-mensuales" onchange="toggleNota('mensuales')"></select>
        <input type="text" id="nota-mensuales" class="nota-input" placeholder="DETALLE / CONCEPTO" style="display:none">
        <label style="color: #059669;">¬øREPETIR MESES? (CUOTAS)</label>
        <input type="number" id="cuotas-mensuales" class="input-cuotas" value="1" min="1" max="24">
        <input type="number" id="monto-mensuales" inputmode="decimal" placeholder="MONTO POR MES $">
        <button class="btn-juan" onclick="guardarGasto('MENSUALES', 'JUAN')">PAG√ì JUAN</button>
        <button class="btn-tania" onclick="guardarGasto('MENSUALES', 'TANIA')">PAG√ì TANIA</button>
    </div>
</div>

<div id="JC" class="container">
    <div class="card">
        <label>SOLO JC (DEUDA JUAN)</label>
        <select id="select-jc" onchange="toggleNota('jc')"></select>
        <input type="text" id="nota-jc" class="nota-input" placeholder="DETALLE DE TARJETA" style="display:none">
        <label style="color: #059669;">¬øREPETIR MESES? (CUOTAS)</label>
        <input type="number" id="cuotas-jc" class="input-cuotas" value="1" min="1" max="24">
        <input type="number" id="monto-jc" inputmode="decimal" placeholder="MONTO POR MES $">
        <button class="btn-tania" onclick="guardarGasto('JC', 'TANIA')">PAG√ì TANIA</button>
    </div>
</div>

<div id="HISTORIAL" class="container">
    <div class="card">
        <label>REPORTE POR PERSONA O RUBRO</label>
        <select id="filtro-rubro" onchange="cargarHistorial()">
            <option value="FILTRO_CASA">GASTOS CASA (DIARIO+MENSUALES)</option>
            <option value="FILTRO_JUAN">PAG√ì JUAN (DIARIO + MENSUAL)</option>
            <option value="FILTRO_TANIA">PAG√ì TANIA (DIARIO + MENSUAL)</option>
            <option value="FILTRO_COMIDA">GASTOS COMIDA (VARIOS)</option>
            <option value="FILTRO_MENSUALES">SOLO LISTA MENSUAL</option>
            <option value="FILTRO_JC">SOLO LISTA JC</option>
        </select>
    </div>
    <div class="nav-historial">
        <button class="btn-nav" onclick="cambiarMesHistorial(-1)">‚óÄ</button>
        <h3 id="titulo-mes-historial" style="margin:0; font-size: 16px;">MES</h3>
        <button class="btn-nav" onclick="cambiarMesHistorial(1)">‚ñ∂</button>
    </div>
    <div id="total-acumulado" class="total-filtro">Total: $0</div>
    <div id="lista-historial"></div>
</div>

<div id="BALANCE" class="container">
    <div class="nav-balance">
        <button class="btn-nav" onclick="cambiarMesBalance(-1)">‚óÄ</button>
        <h3 id="titulo-mes-balance" style="margin:0; font-size: 16px;">MES</h3>
        <button class="btn-nav" onclick="cambiarMesBalance(1)">‚ñ∂</button>
    </div>
    <div class="card" id="resumen-balance"></div>
    <button style="background: #64748b; color: white;" onclick="calcularBalance()">üîÑ ACTUALIZAR</button>
    <button class="btn-cerrar" onclick="cerrarMes()">üîí GUARDAR CIERRE DE MES</button>
</div>

<div id="RESUMENES" class="container"><div id="lista-cierres"></div></div>

<script>
    // Tu configuraci√≥n de Firebase se mantiene intacta
    const firebaseConfig = {
      apiKey: "AIzaSyBDlHjKXf33pCEznyLAmFrTDXVPevrHe9Q",
      authDomain: "gastoscasa-d8bc2.firebaseapp.com",
      databaseURL: "https://gastoscasa-d8bc2-default-rtdb.firebaseio.com",
      projectId: "gastoscasa-d8bc2",
      storageBucket: "gastoscasa-d8bc2.firebasestorage.app",
      messagingSenderId: "749635992986",
      appId: "1:749635992986:web:7916d888f54eb5c3ab0e23",
      measurementId: "G-PHML1K224T"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const ServerValue = firebase.database.ServerValue;
    
    let fechaBalanceView = new Date();
    let fechaHistorialView = new Date();
    let balanceActual = {};

    const listas = {
        diarios: ["AGUA", "AUTO GASTOS", "AVICOLA", "BOLSAS", "CARNICERIA", "CASA VARIOS", "COMBUSTIBLE", "COMIDAS AFUERA", "DENTISTA", "EMPANADAS", "FARMACIA", "FCA. PASTAS", "FERIA PAPEL/CAFE", "FERIA VARIOS", "FERIA VERDURA", "FERRETERIA", "GASTOS ARTIGAS", "GATA COMIDA-PIEDRAS", "LA MOLIENDA", "LAVANDERIA", "PANADERIA", "PANADERIA S/G", "PEAJES", "PESCADERIA", "PIZZA", "PROPINAS", "REGALOS", "SUPERGAS", "SUPERMERCADO", "VARIOS", "VERDULERIA", "VETERINARIA EXTRAS"],
        mensuales: ["A.N.V Juan", "A.N.V. Tania", "ABERTURAS", "CASA VARIOS", "ELECTRICIDAD", "ESPA√ëOLA MOVIL", "GASTOS COMUNES DOLARES", "GASTOS COMUNES PESOS", "HBO", "INTERNET", "NETFLIX", "OLLA LEO FA", "SERVICIO FUNEBRE", "VARIOS", "VETERINARIA", "TARJETA BROU REC.", "TARJETA ITAU", "TARJETA OCA", "MANTENIMIENTO AUTO", "CONTRIBUCION INMOBILIARIA", "IMP. PRIMARIA", "IMP. PUERTA", "PATENTE RODADOS", "SEGURO CASA Y AUTO"],
        jc: ["EL TUNEL", "LA MOLIENDA", "CLUB AEBU", "MOVILES", "MEDICAMENTOS ESP.", "GASTOS OCA", "GASTOS ITAU", "GASTOS SANTANDER"]
    };

    function toggleNota(tipo) {
        const item = document.getElementById(`select-${tipo}`).value;
        const rubrosConNota = ["CASA VARIOS", "REGALOS", "COMIDAS AFUERA", "VARIOS", "GASTOS OCA", "GASTOS ITAU", "GASTOS SANTANDER"];
        const inputNota = document.getElementById(`nota-${tipo}`);
        if(inputNota) inputNota.style.display = rubrosConNota.includes(item) ? "block" : "none";
    }

    function cargarListas() {
        const comboHistorial = document.getElementById('filtro-rubro');
        const full = [...listas.diarios, ...listas.mensuales, ...listas.jc].sort();
        full.forEach(i => {
            const opt = document.createElement('option');
            opt.value = i; opt.innerText = i;
            comboHistorial.appendChild(opt);
        });
        listas.diarios.sort().forEach(i => document.getElementById('select-diarios').innerHTML += `<option value="${i}">${i}</option>`);
        listas.mensuales.sort().forEach(i => document.getElementById('select-mensuales').innerHTML += `<option value="${i}">${i}</option>`);
        listas.jc.sort().forEach(i => document.getElementById('select-jc').innerHTML += `<option value="${i}">${i}</option>`);
    }

    async function guardarGasto(tipo, pagador) {
        const item = document.getElementById(`select-${tipo.toLowerCase()}`).value;
        const notaInput = document.getElementById(`nota-${tipo.toLowerCase()}`);
        const nota = (notaInput && notaInput.style.display !== 'none') ? notaInput.value : "";
        const inputMonto = document.getElementById(`monto-${tipo.toLowerCase()}`);
        const monto = parseFloat(inputMonto.value);
        let cuotas = (tipo === 'MENSUALES' || tipo === 'JC') ? (parseInt(document.getElementById(`cuotas-${tipo.toLowerCase()}`).value) || 1) : 1;
        if (!monto || monto <= 0) return alert("MONTO INV√ÅLIDO");

        const snapshot = await db.ref(`gastos_global`).once('value');
        let yaExiste = false;
        if (tipo === 'MENSUALES' && item !== "CASA VARIOS" && item !== "VARIOS") {
            snapshot.forEach(child => {
                const g = child.val();
                if (g.tipo === 'MENSUALES' && g.item === item && g.mesAnio === `${new Date().getMonth()+1}-${new Date().getFullYear()}`) yaExiste = true;
            });
        }
        if (yaExiste) { alert(`‚ö†Ô∏è ERROR: "${item}" ya est√° cargado este mes.`); return; }

        const promesas = [];
        const hoy = new Date();
        for(let i = 0; i < cuotas; i++) {
            let fF = new Date(hoy.getFullYear(), hoy.getMonth() + i, (i === 0 ? hoy.getDate() : 15));
            const mesAnio = `${fF.getMonth() + 1}-${fF.getFullYear()}`;
            const nF = cuotas > 1 ? `${nota} (${i+1}/${cuotas})`.trim() : nota;
            promesas.push(db.ref(`gastos_global`).push({ tipo, item, nota: nF, monto, pagador, fecha: fF.toISOString().split('T')[0], mesAnio, timestamp: ServerValue.TIMESTAMP }));
        }
        Promise.all(promesas).then(() => { alert("‚úÖ GUARDADO"); inputMonto.value = ""; if(notaInput) notaInput.style.display = "none"; refrescarVistas(); });
    }

    function refrescarVistas() {
        if(document.getElementById('HISTORIAL').classList.contains('active')) cargarHistorial();
        if(document.getElementById('BALANCE').classList.contains('active')) calcularBalance();
    }

    function cambiarMesHistorial(n) { fechaHistorialView.setMonth(fechaHistorialView.getMonth() + n); refrescarVistas(); }

    function cargarHistorial() {
        const filtro = document.getElementById('filtro-rubro').value;
        const mesesNombres = ["ENERO", "FEBRERO", "MARZO", "ABRIL", "MAYO", "JUNIO", "JULIO", "AGOSTO", "SEPTIEMBRE", "OCTUBRE", "NOVIEMBRE", "DICIEMBRE"];
        const mesAnio = `${fechaHistorialView.getMonth() + 1}-${fechaHistorialView.getFullYear()}`;
        document.getElementById('titulo-mes-historial').innerText = `${mesesNombres[fechaHistorialView.getMonth()]} ${fechaHistorialView.getFullYear()}`;
        
        db.ref(`gastos_global`).orderByChild('mesAnio').equalTo(mesAnio).once('value', (s) => {
            let gastos = [];
            s.forEach(c => { let g = c.val(); g.id = c.key; gastos.push(g); });
            let html = ""; let totalGeneral = 0;

            if (filtro === 'FILTRO_JUAN' || filtro === 'FILTRO_TANIA') {
                const persona = filtro === 'FILTRO_JUAN' ? 'JUAN' : 'TANIA';
                const d = gastos.filter(g => g.pagador === persona && g.tipo === 'DIARIOS');
                const m = gastos.filter(g => g.pagador === persona && g.tipo === 'MENSUALES');
                const jc = persona === 'JUAN' ? gastos.filter(g => g.tipo === 'JC') : [];
                html += `<div class="subtotal-seccion"><span>DIARIOS</span><span>$${d.reduce((acc,g)=>acc+g.monto,0).toFixed(0)}</span></div>` + d.map(g => itemHtml(g)).join('');
                html += `<div class="subtotal-seccion"><span>MENSUALES</span><span>$${m.reduce((acc,g)=>acc+g.monto,0).toFixed(0)}</span></div>` + m.map(g => itemHtml(g)).join('');
                if(persona === 'JUAN' && jc.length > 0) {
                    html += `<div class="subtotal-seccion" style="background:#cbd5e1"><span>INFO JC (No suma)</span><span>$${jc.reduce((acc,g)=>acc+g.monto,0).toFixed(0)}</span></div>` + jc.map(g => itemHtml(g)).join('');
                }
                totalGeneral = d.reduce((acc,g)=>acc+g.monto,0) + m.reduce((acc,g)=>acc+g.monto,0);
            } else if (filtro === 'FILTRO_CASA') {
                const casa = gastos.filter(g => g.tipo === 'DIARIOS' || g.tipo === 'MENSUALES');
                html = casa.map(g => itemHtml(g)).join('');
                totalGeneral = casa.reduce((acc, g) => acc + g.monto, 0);
            } else if (filtro === 'FILTRO_COMIDA') {
                const rubrosComida = ["CARNICERIA", "SUPERMERCADO", "AVICOLA", "VERDULERIA", "FERIA VERDURA", "PIZZA", "EMPANADAS", "PESCADERIA", "FCA. PASTAS", "COMIDAS AFUERA", "PANADERIA", "PANADERIA S/G"];
                const comida = gastos.filter(g => rubrosComida.includes(g.item));
                html = comida.map(g => itemHtml(g)).join('');
                totalGeneral = comida.reduce((acc, g) => acc + g.monto, 0);
            } else {
                gastos.forEach(g => {
                    if ((filtro === 'FILTRO_JC' && g.tipo === 'JC') || (filtro === 'FILTRO_MENSUALES' && g.tipo === 'MENSUALES') || (g.item === filtro)) {
                        html += itemHtml(g); totalGeneral += g.monto;
                    }
                });
            }
            document.getElementById('lista-historial').innerHTML = html;
            document.getElementById('total-acumulado').innerText = `TOTAL: $${totalGeneral.toFixed(0)}`;
        });
    }

    function itemHtml(g) {
        const f = g.fecha.split('-');
        return `<div class="card historial-item ${g.tipo === 'JC' ? 'item-jc' : ''}" style="padding:15px; margin-bottom:10px;">
            <div><small style="color:#94a3b8">${f[2]}/${f[1]}</small><br><b style="font-size:15px">${g.item}</b><br>${g.nota ? `<span class="item-nota">${g.nota}</span><br>` : ''}<span class="item-pagador">${g.tipo === 'JC' ? 'LISTA JC' : 'PAG√ì: ' + g.pagador}</span></div>
            <div style="text-align:right"><b style="font-size:16px; color:var(--text-main)">$${g.monto}</b><br><button style="width:auto;padding:6px 12px;background:#fee2e2;color:#ef4444;font-size:12px;margin-top:8px; border-radius:8px" onclick="eliminarGasto('${g.id}')">BORRAR</button></div>
        </div>`;
    }

    function eliminarGasto(id) { if(confirm("¬øBorrar este gasto?")) db.ref(`gastos_global/${id}`).remove().then(()=>refrescarVistas()); }
    function cambiarMesBalance(n) { fechaBalanceView.setMonth(fechaBalanceView.getMonth() + n); refrescarVistas(); }

    function calcularBalance() {
        const mesAnio = `${fechaBalanceView.getMonth() + 1}-${fechaBalanceView.getFullYear()}`;
        document.getElementById('titulo-mes-balance').innerText = `${["ENERO","FEBRERO","MARZO","ABRIL","MAYO","JUNIO","JULIO","AGOSTO","SEPTIEMBRE","OCTUBRE","NOVIEMBRE","DICIEMBRE"][fechaBalanceView.getMonth()]} ${fechaBalanceView.getFullYear()}`;
        db.ref(`gastos_global`).orderByChild('mesAnio').equalTo(mesAnio).once('value', (s) => {
            let j50 = 0, t50 = 0, totalJC = 0;
            s.forEach(c => {
                const g = c.val();
                if (g.tipo === 'JC') totalJC += g.monto;
                else if (g.pagador === 'JUAN') j50 += g.monto;
                else if (g.pagador === 'TANIA') t50 += g.monto;
            });
            const deudaJuan = ((j50 + t50) / 2 - j50) + totalJC;
            balanceActual = { j50, t50, totalJC, deudaJuan, mesAnio };
            document.getElementById('resumen-balance').innerHTML = `
                <div class="balance-item"><span>Juan pag√≥ (50/50):</span> <strong>$${j50.toFixed(0)}</strong></div>
                <div class="balance-item"><span>Tania pag√≥ (50/50):</span> <strong>$${t50.toFixed(0)}</strong></div>
                <div class="balance-item"><span>Total JC (Deuda J):</span> <strong>$${totalJC.toFixed(0)}</strong></div>
                <div class="resultado ${deudaJuan > 0 ? 'debe-juan' : 'debe-tania'}">
                    ${deudaJuan > 0 ? `JUAN DEBE PAGAR: $${deudaJuan.toFixed(0)}` : `TANIA DEBE PAGAR: $${Math.abs(deudaJuan).toFixed(0)}`}
                </div>`;
        });
    }

    function cerrarMes() { if(confirm("¬øGuardar este cierre de mes?")) db.ref(`cierres_mensuales/${balanceActual.mesAnio}`).set({ ...balanceActual, fechaCierre: new Date().toISOString() }).then(() => alert("üîí Cierre Guardado")); }
    
    function cargarCierres() { 
        db.ref(`cierres_mensuales`).once('value', (s) => { 
            let html = "<h3 style='text-align:center; color:var(--text-muted); font-size:14px'>REPORTES GUARDADOS</h3>"; 
            s.forEach(c => { 
                const r = c.val(); 
                html += `<div class="card"><b>MES: ${r.mesAnio}</b><br><small>Juan: $${r.j50.toFixed(0)} | Tania: $${r.t50.toFixed(0)} | JC: $${r.totalJC.toFixed(0)}</small><div class="resultado ${r.deudaJuan > 0 ? `debe-juan` : `debe-tania`}" style="font-size:13px; padding:10px; margin-top:10px">${r.deudaJuan > 0 ? `JUAN DEBI√ì: $${r.deudaJuan.toFixed(0)}` : `TANIA DEBI√ì: $${Math.abs(r.deudaJuan).toFixed(0)}`}</div></div>`; 
            }); 
            document.getElementById('lista-cierres').innerHTML = html; 
        }); 
    }

    function showTab(id, btn) {
        document.querySelectorAll('.container').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
        refrescarVistas();
        if(id === 'RESUMENES') cargarCierres();
        window.scrollTo(0,0);
    }
    window.onload = () => { cargarListas(); refrescarVistas(); };
</script>
</body>
</html>
